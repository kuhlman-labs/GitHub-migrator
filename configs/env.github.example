# =============================================================================
# GitHub to GitHub Migration - Environment Configuration
# =============================================================================
# Copy this file to `.env` and customize for your GitHub source setup
#
# This configuration is specifically for:
#   SOURCE: GitHub (GitHub.com or Enterprise Server)
#   DESTINATION: GitHub (Enterprise Cloud, EMU, or Data Residency)
#
# For Azure DevOps sources, use: env.azuredevops.example
# =============================================================================

# =============================================================================
# Server Configuration
# =============================================================================
GHMIG_SERVER_PORT=8080

# =============================================================================
# Database Configuration
# =============================================================================
# Database type: "sqlite", "postgres", or "sqlserver"
GHMIG_DATABASE_TYPE=sqlite
GHMIG_DATABASE_DSN=./data/migrator.db

# Optional: Database connection pool settings (uncomment if using PostgreSQL/SQL Server)
# GHMIG_DATABASE_MAX_OPEN_CONNS=25
# GHMIG_DATABASE_MAX_IDLE_CONNS=5
# GHMIG_DATABASE_CONN_MAX_LIFETIME_SECONDS=300

# PostgreSQL specific (if using postgres)
# GHMIG_DATABASE_SSL_MODE=require

# SQL Server specific (if using sqlserver)
# GHMIG_DATABASE_TRUST_SERVER_CERTIFICATE=false

# =============================================================================
# SOURCE: GitHub Configuration
# =============================================================================

# Source type - MUST be "github"
GHMIG_SOURCE_TYPE=github

# GitHub Base URL
# - For GitHub Cloud: https://api.github.com
# - For GitHub Enterprise Server: https://github.example.com/api/v3
GHMIG_SOURCE_BASE_URL=https://api.github.com

# --- Authentication: ---

# Personal Access Token (PAT) - Required
# Create at: GitHub → Settings → Developer settings → Personal access tokens → Tokens (classic)
# Required scopes: repo, admin:org (if migrating org resources)
GHMIG_SOURCE_TOKEN=ghp_YourGitHubPATHere

# GitHub App ( ptional - For Discovery and Profiling)
# Create at: GitHub → Settings → Developer settings → GitHub Apps
# GHMIG_SOURCE_APP_ID=123456
# GHMIG_SOURCE_APP_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\nYourKey\n-----END RSA PRIVATE KEY-----
# GHMIG_SOURCE_APP_INSTALLATION_ID=789012

# =============================================================================
# DESTINATION: GitHub Configuration  
# =============================================================================

# Destination type - MUST be "github"
GHMIG_DESTINATION_TYPE=github

# GitHub Base URL
# - For GitHub Cloud: https://api.github.com
# - For GitHub Enterprise Server: https://github.example.com/api/v3
GHMIG_DESTINATION_BASE_URL=https://api.github.com

# --- Authentication: Choose ONE method ---

# METHOD 1: Personal Access Token (PAT)
# Can be the same token as source if migrating within the same instance
GHMIG_DESTINATION_TOKEN=ghp_YourDestinationGitHubPATHere

# METHOD 2: GitHub App
# GHMIG_DESTINATION_APP_ID=234567
# GHMIG_DESTINATION_APP_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\nYourKey\n-----END RSA PRIVATE KEY-----
# GHMIG_DESTINATION_APP_INSTALLATION_ID=890123

# =============================================================================
# Migration Settings
# =============================================================================

# Number of concurrent migration workers
GHMIG_MIGRATION_WORKERS=5

# Polling interval for migration status (seconds)
GHMIG_MIGRATION_POLL_INTERVAL_SECONDS=30

# Post-migration settings mode: "production_only", "always", or "never"
GHMIG_MIGRATION_POST_MIGRATION_MODE=production_only

# Action when destination repo exists: "fail", "skip", or "overwrite"
GHMIG_MIGRATION_DEST_REPO_EXISTS_ACTION=fail

# Visibility handling for public repositories: "public", "private", or "internal"
GHMIG_MIGRATION_VISIBILITY_HANDLING_PUBLIC_REPOS=private

# Visibility handling for internal repositories: "internal", "private", or "public"
GHMIG_MIGRATION_VISIBILITY_HANDLING_INTERNAL_REPOS=private

# =============================================================================
# Logging Configuration
# =============================================================================
GHMIG_LOGGING_LEVEL=info
GHMIG_LOGGING_FORMAT=json
GHMIG_LOGGING_OUTPUT_FILE=./logs/migrator.log
GHMIG_LOGGING_MAX_SIZE=100
GHMIG_LOGGING_MAX_BACKUPS=3
GHMIG_LOGGING_MAX_AGE=28

# =============================================================================
# Authentication & Authorization (Optional - for web UI)
# =============================================================================

# Enable authentication for web interface
GHMIG_AUTH_ENABLED=false

# --- GitHub OAuth App Configuration (if auth enabled) ---
# Create at: GitHub → Settings → Developer settings → OAuth Apps
# GHMIG_AUTH_GITHUB_OAUTH_CLIENT_ID=Iv1.YourClientID
# GHMIG_AUTH_GITHUB_OAUTH_CLIENT_SECRET=YourClientSecret
# GHMIG_AUTH_CALLBACK_URL=http://localhost:8080/api/v1/auth/callback
# GHMIG_AUTH_FRONTEND_URL=http://localhost:3000

# Session configuration
# GHMIG_AUTH_SESSION_SECRET=your-random-secret-key-here-use-openssl-rand-base64-32
# GHMIG_AUTH_SESSION_DURATION_HOURS=24

# --- Authorization Rules (Optional) ---
# Restrict access to specific organizations
# GHMIG_AUTH_AUTHORIZATION_RULES_REQUIRE_ORG_MEMBERSHIP=org1,org2

# Restrict access to specific teams (format: "org/team-slug")
# GHMIG_AUTH_AUTHORIZATION_RULES_REQUIRE_TEAM_MEMBERSHIP=org1/admins,org2/migration-team

# Require GitHub Enterprise admin role
# GHMIG_AUTH_AUTHORIZATION_RULES_REQUIRE_ENTERPRISE_ADMIN=false

# Require enterprise membership
# GHMIG_AUTH_AUTHORIZATION_RULES_REQUIRE_ENTERPRISE_MEMBERSHIP=false
# GHMIG_AUTH_AUTHORIZATION_RULES_REQUIRE_ENTERPRISE_SLUG=your-enterprise

# Privileged teams (format: "org/team-slug") - grants full migration access
# GHMIG_AUTH_AUTHORIZATION_RULES_PRIVILEGED_TEAMS=platform-eng/migration-admins

# =============================================================================
# GitHub-Specific Features
# =============================================================================

# OAuth Base URL (if different from source URL)
# GHMIG_AUTH_GITHUB_OAUTH_BASE_URL=https://github.example.com

# Organization for discovery (when using GitHub App JWT-only auth)
# GHMIG_SOURCE_ORGANIZATION=your-github-org

# =============================================================================
# Quick Start Examples
# =============================================================================

# Example 1: GitHub Cloud to GitHub Cloud (Simple PAT auth)
# GHMIG_SOURCE_TYPE=github
# GHMIG_SOURCE_BASE_URL=https://api.github.com
# GHMIG_SOURCE_TOKEN=ghp_sourcetoken
# GHMIG_DESTINATION_TYPE=github
# GHMIG_DESTINATION_BASE_URL=https://api.github.com
# GHMIG_DESTINATION_TOKEN=ghp_desttoken

# Example 2: GitHub Enterprise Server to GitHub Cloud
# GHMIG_SOURCE_TYPE=github
# GHMIG_SOURCE_BASE_URL=https://github.company.com/api/v3
# GHMIG_SOURCE_TOKEN=ghp_sourcetoken
# GHMIG_DESTINATION_TYPE=github
# GHMIG_DESTINATION_BASE_URL=https://api.github.com
# GHMIG_DESTINATION_TOKEN=ghp_desttoken

# Example 3: Using GitHub App for source
# GHMIG_SOURCE_TYPE=github
# GHMIG_SOURCE_BASE_URL=https://api.github.com
# GHMIG_SOURCE_APP_ID=123456
# GHMIG_SOURCE_APP_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----...
# GHMIG_SOURCE_APP_INSTALLATION_ID=789012
# GHMIG_DESTINATION_TYPE=github
# GHMIG_DESTINATION_BASE_URL=https://api.github.com
# GHMIG_DESTINATION_TOKEN=ghp_desttoken

# =============================================================================
# Notes
# =============================================================================
# 1. All environment variables use the GHMIG_ prefix
# 2. For GitHub sources, use either PAT or GitHub App authentication
# 3. The destination must always be GitHub (GEI requirement)
# 4. For help: see docs/OPERATIONS.md or docs/deployment/

